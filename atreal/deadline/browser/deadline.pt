<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:i18n="http://xml.zope.org/namespaces/i18n"
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     class="deadline"
     id="content-deadline"
     i18n:domain="atreal.deadline"
     tal:define="canModify view/canModify;
                 hasDeadline view/hasDeadline;
                 hasComment view/hasComment;
                 site_url view/site_url;"
     tal:condition="python:True">
  

  <style type="text/css" media="all"
          tal:content="structure string:@import url(${site_url}/jscalendar/calendar-system.css);"/>

  <div id="deadline-display" tal:attributes="class site_url">
    <tal:canmodify condition="canModify">
        <span tal:condition="not:hasDeadline"
              class="action dl-add"
              i18n:attributes="title add"
              title="Add"></span>
        <span tal:condition="hasDeadline"
              class="action dl-modify"
              i18n:attributes="title modify" title="Modify"></span>
        <span tal:condition="hasDeadline"
              class="action dl-history"
              i18n:attributes="title close" title="History"></span>
        <!--<span tal:condition="hasDeadline" class="action dl-delete" i18n:translate="delete" title="delete"></span>-->
        <span tal:condition="not:hasDeadline" i18n:translate="Deadline">Deadline</span>
    </tal:canmodify>
    <span class="dl-date"
          tal:condition="hasDeadline"
          tal:content="view/getDeadline"></span>
    <img tal:condition="hasComment" tal:attributes="src string:${site_url}/arrowRight.gif"/>
    <span class="dl-comment"
          tal:condition="hasComment"
          tal:content="view/getComment"></span>
    
  </div>

  <div id="deadline-form" style="display:none;">
    <form method="POST" 
          tal:attributes="action string:${here/absolute_url}/@@deadline_provider/submitDeadlineForm"
          tal:define="uniqueItemIndex view/uniqueItemIndex;
                      config view/getConfig;">
      <div class="field"
           tal:define="inputname  string:Deadline;
                       formname   string:deadline_form;
                       inputvalue config/deadline;
                       ">
        <img tal:attributes="src string:${site_url}/arrowRight.gif" alt="arrowRight"/>
        <label for="Deadline" i18n:translate="label_new_deadline">New deadline</label> :
        <span metal:use-macro="here/calendar_macros/macros/calendarDatePickerBox" />
      </div>
    
      <div class="field">
        <img tal:attributes="src string:${site_url}/arrowRight.gif" alt="arrowRight"/>
        <label for="comment" 
               i18n:translate="label_comments">Comments</label>
        <br/>
        <textarea id="comment"
                  name="comment"
                  cols="60"
                  rows="2" 
                  tal:content="config/comment|nothing">
        </textarea>
      </div>      
      <!--<div class="field">-->
      <!--  <label for="Responsible">Responsible</label>-->
      <!--  <div>-->
      <!--    <select name="Responsible" id="Responsible" tal:define="responsible here/@@deadline_provider/getResponsible">-->
      <!--      <tal:users repeat="user here/@@deadline_provider/getPossibleResponsible">-->
      <!--        <option tal:content="user/fullname"-->
      <!--                tal:attributes="value user/id; selected python:responsible==user['id']" />-->
      <!--      </tal:users>-->
      <!--    </select>-->
      <!--  </div>-->
      <!--</div>-->
      <input class="context" type="submit"
             i18n:attributes="value label_save"
             value="Save" />
      <input class="standalone" type="reset"
             i18n:attributes="value label_reset"
             value="Reset" />
      <br/>

    </form>
  </div>
  
  <div tal:condition="hasDeadline" id="deadline-history" style="display:none">
    <img tal:attributes="src string:${site_url}/arrowRight.gif" alt="arrowRight"/>
    <span i18n:translate="deadline_history">Deadline history</span>
    <table class="listing sortable"
           summary="Deadline history"
           i18n:attributes="summary deadline_history"
           tal:define="history view/getHistory">
      <tr>
        <th i18n:translate="deadlines">Deadlines</th>
        <th i18n:translate="comments">Comments</th>            
      </tr>
      <tr tal:repeat="entry history">
        <td tal:content="entry/deadline"/>
        <td tal:content="entry/comment"/>
      </tr>
    </table>
  </div>
  
</div>
