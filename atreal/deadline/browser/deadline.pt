<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:i18n="http://xml.zope.org/namespaces/i18n"
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     class="deadline"
     id="content-deadline"
     i18n:domain="atreal.deadline"
     tal:define="canModify view/canModify;
                 hasDeadline view/hasDeadline;
                 hasComment view/hasComment"
     tal:condition="python:True">
  

  <style type="text/css" media="all"
          tal:content="structure string:@import url(${view/site_url}/jscalendar/calendar-system.css);"/>

  <div id="deadline-display" tal:attributes="class view/site_url">
    <tal:canmodify condition="canModify">
        <span class="action dl-add" i18n:translate="add"
              tal:condition="not:hasDeadline"
              title="Add">
        </span>
        <span tal:condition="hasDeadline" class="action dl-modify" i18n:translate="modify" title="Modify"></span>
        <span tal:condition="hasDeadline" class="action dl-history" i18n:translate="close" title="History"></span>
        <!--<span tal:condition="hasDeadline" class="action dl-delete" i18n:translate="delete" title="delete"></span>-->
        <span tal:condition="not:hasDeadline">Deadline</span>
    </tal:canmodify>
    <span class="dl-date"
          tal:condition="hasDeadline"
          tal:content="view/getDeadline"></span>
    <img tal:condition="hasComment" tal:attributes="src string:${here/absolute_url}/arrowRight.gif"/>
    <span class="dl-comment"
          tal:condition="hasComment"
          tal:content="view/getComment"></span>
    
  </div>

  <div id="deadline-form" style="display:none;">
    <form method="POST" 
          tal:attributes="action string:${here/absolute_url}/@@deadline_provider/submitDeadlineForm"
          tal:define="uniqueItemIndex view/uniqueItemIndex;
                      config view/getConfig;">
      <div class="field"
           tal:define="inputname  string:Deadline;
                       formname   string:deadline_form;
                       inputvalue config/deadline;
                       ">
        <label for="Deadline">New deadline</label> :
        <span metal:use-macro="here/calendar_macros/macros/calendarDatePickerBox" />
      </div>
    
      <div class="field">
        <label for="comment" 
               i18n:translate="label_comments">Comments</label>
        <br/>
        <textarea id="comment"
                  name="comment"
                  cols="60"
                  rows="2" 
                  tal:content="config/comment|nothing">
        </textarea>
      </div>      
      <!--<div class="field">-->
      <!--  <label for="Responsible">Responsible</label>-->
      <!--  <div>-->
      <!--    <select name="Responsible" id="Responsible" tal:define="responsible here/@@deadline_provider/getResponsible">-->
      <!--      <tal:users repeat="user here/@@deadline_provider/getPossibleResponsible">-->
      <!--        <option tal:content="user/fullname"-->
      <!--                tal:attributes="value user/id; selected python:responsible==user['id']" />-->
      <!--      </tal:users>-->
      <!--    </select>-->
      <!--  </div>-->
      <!--</div>-->
  
      <input class="standalone" type="reset" value="Reset" />
      <input class="standalone" type="submit" value="Save" />
      <br/>

    </form>
  </div>
  
  <div tal:condition="hasDeadline" id="deadline-history" style="display:none">
    <table class="listing sort" summary="Deadline history">
      <tr>
        <th collspan="2" i18n:translate="history">History</th>
      </tr>
      <tr>
        <th i18n:translate="deadlines">Deadlines</th>
        <th i18n:translate="comments">Comments</th>            
      </tr>
      <!--<td/>-->
    </table>
  </div>
  
</div>
